<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSGOé£æ ¼æ­¦å™¨ç®±å¼€ç®±</title>
    <style>
        :root {
            --purple-border: #9c27b0;
            --red-border: #f44336;
            --orange-border: #ff9800;
            --gold-border: #ffd700;
            --primary-color: #2196f3;
            --dark-bg: #1a1a1a;
            --darker-bg: #121212;
            --light-text: #e0e0e0;
            --container-bg: #252525;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--light-text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        header {
            background-color: var(--darker-bg);
            padding: 15px 0;
            border-bottom: 1px solid #333;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .balance {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .balance-icon {
            color: var(--gold-border);
        }
        
        .nav-buttons {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1976d2;
        }
        
        .btn-success {
            background-color: #4caf50;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #388e3c;
        }
        
        .btn-danger {
            background-color: #f44336;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #d32f2f;
        }
        
        main {
            flex: 1;
            padding: 20px 0;
        }
        
        .section-title {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
            color: var(--primary-color);
        }
        
        /* æŠ½å¥–åŒºåŸŸ */
        .lottery-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
        }
        
        .case-container {
            position: relative;
            width: 300px;
            height: 200px;
            margin-bottom: 20px;
            border: 2px solid #444;
            border-radius: 8px;
            overflow: hidden;
            background-color: var(--container-bg);
        }
        
        .case-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .open-case-btn {
            padding: 12px 30px;
            font-size: 18px;
            background-color: var(--orange-border);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
        }
        
        .open-case-btn:hover {
            background-color: #f57c00;
        }
        
        .lottery-buttons {
            display: flex;
            margin-top: 20px;
        }
        
        /* å•†å“å±•ç¤º */
        .items-section {
            margin-bottom: 40px;
        }
        
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
        }
        
        .item-card {
            background-color: var(--container-bg);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .item-card:hover {
            transform: translateY(-5px);
        }
        
        .item-image-container {
            position: relative;
            padding-top: 75%;
            overflow: hidden;
        }
        
        .item-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
            background-color: #333;
        }
        
        .item-rarity {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .item-info {
            padding: 10px;
        }
        
        .item-name {
            font-size: 14px;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .item-price {
            font-size: 16px;
            font-weight: bold;
            color: var(--gold-border);
        }
        
        .item-wear {
            font-size: 12px;
            color: #aaa;
        }
        
        /* æœ€è¿‘å‡ºè´§ */
        .recent-drops {
            margin-bottom: 40px;
        }
        
        .recent-drops-container {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 10px 0;
        }
        
        .recent-drop {
            flex: 0 0 120px;
            background-color: var(--container-bg);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
        }
        
        .recent-drop-image {
            width: 100%;
            height: 80px;
            object-fit: contain;
            margin-bottom: 5px;
        }
        
        .recent-drop-time {
            font-size: 12px;
            color: #aaa;
        }
        
        /* æŠ½å¥–åŠ¨ç”» */
        .lottery-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .lottery-slots {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .slot-container {
            position: relative;
            width: 600px;
            height: 100px;
            overflow: hidden;
            border: 2px solid #444;
            border-radius: 8px;
        }
        
        .slot-items {
            display: flex;
            position: absolute;
            left: 0;
            transition: left 0.1s linear;
        }
        
        .slot-item {
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--container-bg);
        }
        
        .slot-item img {
            max-width: 90%;
            max-height: 90%;
        }
        
        .slot-pointer {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 100%;
            background-color: red;
            z-index: 10;
        }
        
        .lottery-result {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--container-bg);
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            z-index: 1001;
            max-width: 80%;
        }
        
        .result-item {
            margin-bottom: 20px;
        }
        
        .result-item-image {
            max-width: 200px;
            max-height: 150px;
            margin-bottom: 10px;
        }
        
        .result-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        /* å……å€¼æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: var(--container-bg);
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            text-align: center;
        }
        
        .modal-title {
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            text-align: left;
        }
        
        .input-group input {
            width: 100%;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #444;
            background-color: #333;
            color: white;
        }
        
        .qr-code {
            max-width: 200px;
            margin: 20px auto;
            display: none;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        /* ä»“åº“ */
        .inventory-section {
            margin-bottom: 40px;
        }
        
        .inventory-tabs {
            display: flex;
            border-bottom: 1px solid #444;
            margin-bottom: 20px;
        }
        
        .inventory-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .inventory-tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .inventory-content {
            display: none;
        }
        
        .inventory-content.active {
            display: block;
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .inventory-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        /* å†å²è®°å½• */
        .history-section table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .history-section th, .history-section td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #444;
        }
        
        .history-section th {
            background-color: var(--darker-bg);
        }
        
        /* è¾¹æ¡†é¢œè‰² */
        .border-purple {
            border: 2px solid var(--purple-border);
        }
        
        .border-red {
            border: 2px solid var(--red-border);
        }
        
        .border-orange {
            border: 2px solid var(--orange-border);
        }
        
        .border-gold {
            border: 2px solid var(--gold-border);
        }
        
        /* ç¨€æœ‰åº¦æ ‡ç­¾ */
        .rarity-common {
            color: #b0b0b0;
        }
        
        .rarity-uncommon {
            color: #5e9e4f;
        }
        
        .rarity-rare {
            color: #4a8fd4;
        }
        
        .rarity-mythical {
            color: #8847ff;
        }
        
        .rarity-legendary {
            color: #d32ce6;
        }
        
        .rarity-ancient {
            color: #eb4b4b;
        }
        
        .rarity-immortal {
            color: #e4ae39;
        }
        
        /* é€šçŸ¥ */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            z-index: 1100;
            display: none;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <header>
        <div class="container header-content">
            <div class="logo">CSGOæ­¦å™¨ç®±å¼€ç®±</div>
            <div class="user-info">
                <div class="balance">
                    <span class="balance-icon">ğŸ’°</span>
                    <span id="user-balance">0.</span> è±†
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-primary" id="recharge-btn">å……å€¼</button>
                    <button class="btn btn-primary" id="inventory-btn">ä»“åº“</button>
                    <button class="btn btn-primary" id="history-btn">å†å²è®°å½•</button>
                </div>
            </div>
        </div>
    </header>
    
    <main class="container">
        <section class="lottery-section">
            <h2 class="section-title">æ­¦å™¨ç®±å¼€ç®±</h2>
            <div class="case-container">
                <img src="æ­¦å™¨ç®±.jpg" alt="æ­¦å™¨ç®±" class="case-image">
            </div>
            <p>æ¯æ¬¡å¼€ç®±æ¶ˆè€—: <strong>128.88</strong> è±†</p>
            <div class="lottery-buttons">
                <button class="open-case-btn" id="open-once">å¼€ç®±ä¸€æ¬¡</button>
                <button class="open-case-btn" id="open-five">å¼€ç®±äº”æ¬¡</button>
            </div>
        </section>
        
        <section class="items-section">
            <h2 class="section-title">å¯è·å–ç‰©å“</h2>
            <div class="items-grid" id="items-grid">
                <!-- ç‰©å“å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
        </section>
        
        <section class="recent-drops">
            <h2 class="section-title">æœ€è¿‘å‡ºè´§</h2>
            <div class="recent-drops-container" id="recent-drops">
                <!-- æœ€è¿‘å‡ºè´§å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
        </section>
    </main>
    
    <!-- æŠ½å¥–åŠ¨ç”» -->
    <div class="lottery-animation" id="lottery-animation">
        <div class="lottery-slots" id="lottery-slots">
            <!-- æŠ½å¥–æ§½å°†é€šè¿‡JavaScriptåŠ¨æ€åˆ›å»º -->
        </div>
    </div>
    
    <!-- æŠ½å¥–ç»“æœ -->
    <div class="lottery-result" id="lottery-result">
        <div class="result-item">
            <img src="" alt="ä¸­å¥–ç‰©å“" class="result-item-image" id="result-item-image">
            <h3 id="result-item-name">ç‰©å“åç§°</h3>
            <p id="result-item-wear">ç£¨æŸç¨‹åº¦</p>
            <p id="result-item-price">0. è±†</p>
        </div>
        <div class="result-buttons">
            <button class="btn btn-success" id="result-exchange">ç½®æ¢</button>
            <button class="btn btn-primary" id="result-continue">ç»§ç»­å¼€ç®±</button>
        </div>
    </div>
    
    <!-- å……å€¼æ¨¡æ€æ¡† -->
    <div class="modal" id="recharge-modal">
        <div class="modal-content">
            <h2 class="modal-title">å……å€¼</h2>
            <div class="input-group">
                <label for="recharge-amount">å……å€¼é‡‘é¢ (è±†)</label>
                <input type="number" id="recharge-amount" min="10" step="10" placeholder="è¯·è¾“å…¥å……å€¼é‡‘é¢">
            </div>
            <img src="å¾®ä¿¡å……å€¼.jpg" alt="å¾®ä¿¡æ”¯ä»˜äºŒç»´ç " class="qr-code" id="qr-code">
            <div class="modal-buttons">
                <button class="btn btn-success" id="recharge-confirm">ç¡®è®¤å……å€¼</button>
                <button class="btn btn-danger" id="recharge-cancel">å–æ¶ˆ</button>
            </div>
            <div class="modal-buttons" id="recharge-after-buttons" style="display: none;">
                <button class="btn btn-success" id="recharge-paid">æˆ‘å·²æ”¯ä»˜</button>
                <button class="btn btn-danger" id="recharge-problem">é‡åˆ°é—®é¢˜</button>
            </div>
            <div id="recharge-feedback" style="display: none; margin-top: 20px;">
                <p>æ­£åœ¨åé¦ˆå®¢æœ...</p>
            </div>
        </div>
    </div>
    
    <!-- ä»“åº“æ¨¡æ€æ¡† -->
    <div class="modal" id="inventory-modal">
        <div class="modal-content">
            <h2 class="modal-title">ä»“åº“</h2>
            <div class="inventory-tabs">
                <div class="inventory-tab active" data-tab="inventory">æˆ‘çš„ç‰©å“</div>
                <div class="inventory-tab" data-tab="sending">æ­£åœ¨å‘é€</div>
            </div>
            
            <div class="inventory-content active" id="inventory-tab">
                <div class="inventory-grid" id="inventory-items">
                    <!-- ä»“åº“ç‰©å“å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                </div>
                <div class="inventory-actions">
                    <button class="btn btn-primary" id="decompose-btn">ä¸€é”®åˆ†è§£</button>
                    <button class="btn btn-success" id="exchange-all-btn">å…¨éƒ¨ç½®æ¢</button>
                </div>
            </div>
            
            <div class="inventory-content" id="sending-tab">
                <div class="inventory-grid" id="sending-items">
                    <!-- æ­£åœ¨å‘é€ç‰©å“å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                </div>
                <div id="sending-info">
                    <p>å‰©ä½™æ—¶é—´: <span id="sending-timer">10:00</span></p>
                    <button class="btn btn-danger" id="cancel-sending-btn">å–æ¶ˆå‘é€</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å†å²è®°å½•æ¨¡æ€æ¡† -->
    <div class="modal" id="history-modal">
        <div class="modal-content">
            <h2 class="modal-title">å†å²è®°å½•</h2>
            <div class="inventory-tabs">
                <div class="inventory-tab active" data-tab="recharge-history">å……å€¼è®°å½•</div>
                <div class="inventory-tab" data-tab="lottery-history">å¼€ç®±è®°å½•</div>
            </div>
            
            <div class="inventory-content active" id="recharge-history-tab">
                <div class="history-section">
                    <table>
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>é‡‘é¢ (è±†)</th>
                                <th>çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody id="recharge-history-table">
                            <!-- å……å€¼è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="inventory-content" id="lottery-history-tab">
                <div class="history-section">
                    <table>
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>ç‰©å“</th>
                                <th>ç£¨æŸ</th>
                                <th>ä»·å€¼ (è±†)</th>
                            </tr>
                        </thead>
                        <tbody id="lottery-history-table">
                            <!-- å¼€ç®±è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="btn btn-danger" id="history-close">å…³é—­</button>
            </div>
        </div>
    </div>
    
    <script>
        // ç‰©å“æ•°æ®
        const items = [
            { name: "è´è¶åˆ€æ¸å˜ä¹‹è‰²", image: "è´è¶åˆ€æ¸å˜ä¹‹è‰².jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.05, price: 3228.47, rarity: "éšç§˜çº§" },
            { name: "è´è¶åˆ€è‡ªåŠ¨åŒ–", image: "è´è¶åˆ€è‡ªåŠ¨åŒ–.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.08, price: 2128.47, rarity: "éšç§˜çº§" },
            { name: "é©¾é©¶æ‰‹å¥—è¥¿è£…é©å±¥", image: "é©¾é©¶æ‰‹å¥—è¥¿è£…é©å±¥.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.31, price: 1028.47, rarity: "å†›éœ€çº§" },
            { name: "é©¾é©¶æ‰‹å¥—é›ªè±¹", image: "é©¾é©¶æ‰‹å¥—é›ªè±¹.jpg", wear: "ç•¥æœ‰å‡ºåœº", probability: 0.5, price: 828.47, rarity: "å†›éœ€çº§" },
            { name: "é”¯é½¿çˆªåˆ€è¡¨é¢æ·¬ç«", image: "é”¯é½¿çˆªåˆ€è¡¨é¢æ·¬ç«.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.6, price: 1028.47, rarity: "å†›éœ€çº§" },
            { name: "é”¯é½¿çˆªåˆ€è¡¨é¢æ·¬ç«", image: "é”¯é½¿çˆªåˆ€è¡¨é¢æ·¬ç«.jpg", wear: "ä¹…ç»æ²™åœº", probability: 0.39999999, price: 841.5, rarity: "å†›éœ€çº§" },
            { name: "éª·é«…åŒ•é¦–", image: "éª·é«…åŒ•é¦–.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.45, price: 1261.51, rarity: "å†›éœ€çº§" },
            { name: "æµæµªè€…åŒ•é¦–å± å¤«", image: "æµæµªè€…åŒ•é¦–å± å¤«.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.459999, price: 1004.90, rarity: "å†›éœ€çº§" },
            { name: "æ‘©æ‰˜æ‰‹å¥—å´©", image: "æ‘©æ‰˜æ‰‹å¥—å´©.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.56999999, price: 2353.03, rarity: "å†›éœ€çº§" },
            { name: "æ‘©æ‰˜æ‰‹å¥—å´©", image: "æ‘©æ‰˜æ‰‹å¥—å´©.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 1.3, price: 930.18, rarity: "å†›éœ€çº§" },
            { name: "å’†å“®M4", image: "å’†å“®M4.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.01, price: 10380.37, rarity: "éšç§˜çº§" },
            { name: "å’†å“®M4", image: "å’†å“®M4.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.08, price: 7133.96, rarity: "éšç§˜çº§" },
            { name: "å’†å“®M4", image: "å’†å“®M4.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.04999999, price: 9276.07, rarity: "éšç§˜çº§" },
            { name: "å’†å“®M4", image: "å’†å“®M4.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.13, price: 2836.32, rarity: "éšç§˜çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—è¿ˆé˜¿å¯†é£äº‘", image: "è¿åŠ¨æ‰‹å¥—è¿ˆé˜¿å¯†é£äº‘.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.1, price: 31058.99, rarity: "éšç§˜çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—è¿ˆé˜¿å¯†é£äº‘", image: "è¿åŠ¨æ‰‹å¥—è¿ˆé˜¿å¯†é£äº‘.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.1, price: 6139.32, rarity: "éšç§˜çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—æ½˜å¤šæ‹‰", image: "è¿åŠ¨æ‰‹å¥—æ½˜å¤šæ‹‰.jpg", wear: "ä¹…ç»æ²™åœº", probability: 0.015, price: 13938.03, rarity: "éšç§˜çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—æ½˜å¤šæ‹‰", image: "è¿åŠ¨æ‰‹å¥—æ½˜å¤šæ‹‰.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.1, price: 18883.30, rarity: "éšç§˜çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—æ ‘ç¯±è¿·å®«", image: "è¿åŠ¨æ‰‹å¥—æ ‘ç¯±è¿·å®«.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.011, price: 79110.23, rarity: "éšç§˜çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—æ ‘ç¯±è¿·å®«", image: "è¿åŠ¨æ‰‹å¥—æ ‘ç¯±è¿·å®«.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.1, price: 27892.38, rarity: "éšç§˜çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—åŒç¡’", image: "è¿åŠ¨æ‰‹å¥—åŒç¡’.jpg", wear: "ä¹…ç»æ²™åœº", probability: 0.56, price: 1178.06, rarity: "å†›éœ€çº§" },
            { name: "è¿åŠ¨æ‰‹å¥—åŒç¡’", image: "è¿åŠ¨æ‰‹å¥—åŒç¡’.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.139999, price: 27892.38, rarity: "å†›éœ€çº§" },
            { name: "çˆªå­åˆ€ä¼ è¯´", image: "çˆªå­åˆ€ä¼ è¯´.jpg", wear: "ä¹…ç»æ²™åœº", probability: 0.23, price: 1616.48, rarity: "å†›éœ€çº§" },
            { name: "çˆªå­åˆ€å¤šæ™®å‹’ï¼ˆçº¢å®çŸ³ï¼‰", image: "çˆªå­åˆ€å¤šæ™®å‹’ï¼ˆçº¢å®çŸ³ï¼‰.jpg", wear: "ä¹…ç»æ²™åœº", probability: 0.1, price: 15901.83, rarity: "éšç§˜çº§" },
            { name: "ä¸“ä¸šæ‰‹å¥—æ¸å˜ä¹‹è‰²", image: "ä¸“ä¸šæ‰‹å¥—æ¸å˜ä¹‹è‰².jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.24, price: 1817.8, rarity: "å†›éœ€çº§" },
            { name: "ä¸“ä¸šæ‰‹å¥—æ·±çº¢å’Œæœ", image: "ä¸“ä¸šæ‰‹å¥—æ·±çº¢å’Œæœ.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.0239999, price: 12133.07, rarity: "éšç§˜çº§" },
            { name: "ä¸“ä¸šæ‰‹å¥—æ·±çº¢ä¹‹ç‹", image: "ä¸“ä¸šæ‰‹å¥—æ·±çº¢ä¹‹ç‹.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.567, price: 1000.18, rarity: "å†›éœ€çº§" },
            { name: "AK47æš—å½±ç ´åè€…", image: "AK47æš—å½±ç ´åè€….jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 16.0000001, price: 8.38, rarity: "å·¥ä¸šçº§" },
            { name: "è´è¶åˆ€è™ç‰™", image: "è´è¶åˆ€è™ç‰™.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.123, price: 1850.32, rarity: "å†›éœ€çº§" },
            { name: "AK47é»„é‡‘è—¤æ›¼", image: "AK47é»„é‡‘è—¤æ›¼.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 0.042, price: 4498.76, rarity: "å†›éœ€çº§" },
            { name: "AK47å¯ç‡ƒå†°", image: "AK47å¯ç‡ƒå†°.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 12, price: 14.49, rarity: "å·¥ä¸šçº§" },
            { name: "AK47è«è¨€", image: "AK47è«è¨€.jpg", wear: "ç•¥æœ‰ç£¨æŸ", probability: 13, price: 8.51, rarity: "å·¥ä¸šçº§" },
            { name: "AK47æ°´æ ½ç«¹", image: "AK47æ°´æ ½ç«¹.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.115, price: 5136.20, rarity: "å†›éœ€çº§" },
            { name: "AK47é‡åˆ", image: "AK47é‡åˆ.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.12, price: 21741.04, rarity: "éšç§˜çº§" },
            { name: "AWPé›·å‡»", image: "AWPé›·å‡».jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.88888899, price: 876.42, rarity: "å†›éœ€çº§" },
            { name: "AWPå·¨é¾™ä¼ è¯´", image: "AWPå·¨é¾™ä¼ è¯´.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.2, price: 20821.71, rarity: "éšç§˜çº§" },
            { name: "AWPæ°¸æ’ä¹‹æª", image: "AWPæ°¸æ’ä¹‹æª.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.2, price: 21119.88, rarity: "éšç§˜çº§" },
            { name: "M4A1æ°®åŒ–å¤„ç†", image: "M4A1æ°®åŒ–å¤„ç†.jpg", wear: "å´­æ–°å‡ºåœº", probability: 12, price: 7.12, rarity: "å·¥ä¸šçº§" },
            { name: "M4A1ä¼Šå¡æ´›æ–¯çš„é™¨è½", image: "M4A1ä¼Šå¡æ´›æ–¯çš„é™¨è½.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.5, price: 817.63, rarity: "å†›éœ€çº§" },
            { name: "M4A4æ­»å¯‚ç©ºé—´", image: "M4A4æ­»å¯‚ç©ºé—´.jpg", wear: "ä¹…ç»æ²™åœº", probability: 10, price: 17.59, rarity: "å·¥ä¸šçº§" },
            { name: "M9åˆºåˆ€å¤šæ™®å‹’ï¼ˆçº¢å®çŸ³ï¼‰", image: "M9åˆºåˆ€å¤šæ™®å‹’ï¼ˆçº¢å®çŸ³ï¼‰.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.1, price: 19504.22, rarity: "éšç§˜çº§" },
            { name: "M9åˆºåˆ€æ¸å˜å¤§ç†çŸ³", image: "M9åˆºåˆ€æ¸å˜å¤§ç†çŸ³.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.15, price: 2220.78, rarity: "å†›éœ€çº§" },
            { name: "M9åˆºåˆ€å¤–è¡¨ç”Ÿé”ˆ", image: "M9åˆºåˆ€å¤–è¡¨ç”Ÿé”ˆ.jpg", wear: "æˆ˜ç—•ç´¯ç´¯", probability: 0.25, price: 789.57, rarity: "å†›éœ€çº§" },
            { name: "M9åˆºåˆ€è‡ªåŠ¨åŒ–", image: "M9åˆºåˆ€è‡ªåŠ¨åŒ–.jpg", wear: "ä¹…ç»æ²™åœº", probability: 0.3, price: 1717.77, rarity: "å†›éœ€çº§" },
            { name: "USPä¸é”ˆé’¢", image: "USPä¸é”ˆé’¢.jpg", wear: "ä¹…ç»æ²™åœº", probability: 10, price: 8.59, rarity: "å·¥ä¸šçº§" },
            { name: "USPè“å›¾", image: "USPè“å›¾.jpg", wear: "ä¹…ç»æ²™åœº", probability: 15, price: 5.60, rarity: "å·¥ä¸šçº§" },
            { name: "åˆºåˆ€", image: "åˆºåˆ€.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.44, price: 850.82, rarity: "å†›éœ€çº§" },
            { name: "åˆºåˆ€å¤šæ™®å‹’", image: "åˆºåˆ€å¤šæ™®å‹’.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.5999999, price: 1005.09, rarity: "å†›éœ€çº§" },
            { name: "åˆºåˆ€è™ç‰™", image: "åˆºåˆ€è™ç‰™.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.8000001, price: 850.32, rarity: "å†›éœ€çº§" },
            { name: "æ ¼æ´›å…‹æ°´çµ", image: "æ ¼æ´›å…‹æ°´çµ.jpg", wear: "å´­æ–°å‡ºåœº", probability: 10.1, price: 8.73, rarity: "å·¥ä¸šçº§" },
            { name: "è´è¶åˆ€éƒ½å¸‚ä¼ªè£…", image: "è´è¶åˆ€éƒ½å¸‚ä¼ªè£….jpg", wear: "ä¹…ç»æ²™åœº", probability: 0.5, price: 990.60, rarity: "å†›éœ€çº§" },
            { name: "è´è¶åˆ€å¤šæ™®å‹’ï¼ˆçº¢å®çŸ³ï¼‰", image: "è´è¶åˆ€å¤šæ™®å‹’ï¼ˆçº¢å®çŸ³ï¼‰.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.1, price: 20705.43, rarity: "éšç§˜çº§" },
            { name: "è´è¶åˆ€å¤šæ™®å‹’", image: "è´è¶åˆ€å¤šæ™®å‹’.jpg", wear: "å´­æ–°å‡ºåœº", probability: 0.8, price: 5519.62, rarity: "éšç§˜çº§" }
        ];

        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            balance: 0,
            inventory: [],
            sendingItems: [],
            rechargeHistory: [],
            lotteryHistory: [],
            recentDrops: []
        };

        // DOMå…ƒç´ 
        const elements = {
            notification: document.getElementById('notification'),
            userBalance: document.getElementById('user-balance'),
            itemsGrid: document.getElementById('items-grid'),
            recentDrops: document.getElementById('recent-drops'),
            lotteryAnimation: document.getElementById('lottery-animation'),
            lotterySlots: document.getElementById('lottery-slots'),
            lotteryResult: document.getElementById('lottery-result'),
            resultItemImage: document.getElementById('result-item-image'),
            resultItemName: document.getElementById('result-item-name'),
            resultItemWear: document.getElementById('result-item-wear'),
            resultItemPrice: document.getElementById('result-item-price'),
            rechargeModal: document.getElementById('recharge-modal'),
            rechargeAmount: document.getElementById('recharge-amount'),
            qrCode: document.getElementById('qr-code'),
            rechargeAfterButtons: document.getElementById('recharge-after-buttons'),
            rechargeFeedback: document.getElementById('recharge-feedback'),
            inventoryModal: document.getElementById('inventory-modal'),
            inventoryItems: document.getElementById('inventory-items'),
            sendingItems: document.getElementById('sending-items'),
            sendingTimer: document.getElementById('sending-timer'),
            historyModal: document.getElementById('history-modal'),
            rechargeHistoryTable: document.getElementById('recharge-history-table'),
            lotteryHistoryTable: document.getElementById('lottery-history-table'),
            openOnceBtn: document.getElementById('open-once'),
            openFiveBtn: document.getElementById('open-five'),
            rechargeBtn: document.getElementById('recharge-btn'),
            inventoryBtn: document.getElementById('inventory-btn'),
            historyBtn: document.getElementById('history-btn'),
            rechargeConfirm: document.getElementById('recharge-confirm'),
            rechargeCancel: document.getElementById('recharge-cancel'),
            rechargePaid: document.getElementById('recharge-paid'),
            rechargeProblem: document.getElementById('recharge-problem'),
            resultExchange: document.getElementById('result-exchange'),
            resultContinue: document.getElementById('result-continue'),
            decomposeBtn: document.getElementById('decompose-btn'),
            exchangeAllBtn: document.getElementById('exchange-all-btn'),
            cancelSendingBtn: document.getElementById('cancel-sending-btn'),
            historyClose: document.getElementById('history-close')
        };

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const notification = elements.notification;
            notification.textContent = message;
            notification.style.display = 'block';
            
            // è®¾ç½®èƒŒæ™¯é¢œè‰²
            if (type === 'success') {
                notification.style.backgroundColor = '#4caf50';
            } else if (type === 'error') {
                notification.style.backgroundColor = '#f44336';
            } else if (type === 'warning') {
                notification.style.backgroundColor = '#ff9800';
            } else {
                notification.style.backgroundColor = '#333';
            }
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ¸¸æˆçŠ¶æ€
            const savedState = localStorage.getItem('csgoCaseGameState');
            if (savedState) {
                gameState = JSON.parse(savedState);
            }
            
            updateBalanceDisplay();
            renderItemsGrid();
            renderRecentDrops();
            
            // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
            setupEventListeners();
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æ­£åœ¨å‘é€çš„ç‰©å“
            checkSendingItems();
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // å¼€ç®±æŒ‰é’®
            elements.openOnceBtn.addEventListener('click', () => openCase(1));
            elements.openFiveBtn.addEventListener('click', () => openCase(5));
            
            // å¯¼èˆªæŒ‰é’®
            elements.rechargeBtn.addEventListener('click', () => elements.rechargeModal.style.display = 'flex');
            elements.inventoryBtn.addEventListener('click', openInventoryModal);
            elements.historyBtn.addEventListener('click', openHistoryModal);
            
            // å……å€¼ç›¸å…³
            elements.rechargeConfirm.addEventListener('click', startRecharge);
            elements.rechargeCancel.addEventListener('click', () => elements.rechargeModal.style.display = 'none');
            elements.rechargePaid.addEventListener('click', completeRecharge);
            elements.rechargeProblem.addEventListener('click', handleRechargeProblem);
            
            // æŠ½å¥–ç»“æœ
            elements.resultExchange.addEventListener('click', exchangeItem);
            elements.resultContinue.addEventListener('click', () => elements.lotteryResult.style.display = 'none');
            
            // ä»“åº“
            elements.decomposeBtn.addEventListener('click', decomposeItems);
            elements.exchangeAllBtn.addEventListener('click', exchangeAllItems);
            elements.cancelSendingBtn.addEventListener('click', cancelSending);
            
            // å†å²è®°å½•
            elements.historyClose.addEventListener('click', () => elements.historyModal.style.display = 'none');
            
            // ä»“åº“æ ‡ç­¾åˆ‡æ¢
            document.querySelectorAll('.inventory-tab[data-tab]').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    document.querySelectorAll('.inventory-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.inventory-content').forEach(c => c.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // å†å²è®°å½•æ ‡ç­¾åˆ‡æ¢
            document.querySelectorAll('#history-modal .inventory-tab[data-tab]').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    document.querySelectorAll('#history-modal .inventory-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('#history-modal .inventory-content').forEach(c => c.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        // æ›´æ–°ä½™é¢æ˜¾ç¤º
        function updateBalanceDisplay() {
            elements.userBalance.textContent = gameState.balance.toFixed(2);
        }

        // æ¸²æŸ“ç‰©å“ç½‘æ ¼
        function renderItemsGrid() {
            elements.itemsGrid.innerHTML = '';
            
            items.forEach(item => {
                const itemCard = document.createElement('div');
                itemCard.className = 'item-card';
                
                // æ ¹æ®ä»·æ ¼è®¾ç½®è¾¹æ¡†é¢œè‰²
                if (item.price > 2000) {
                    itemCard.classList.add('border-gold');
                } else if (item.price > 1500) {
                    itemCard.classList.add('border-orange');
                } else if (item.price > 1000) {
                    itemCard.classList.add('border-red');
                } else if (item.price > 500) {
                    itemCard.classList.add('border-purple');
                }
                
                itemCard.innerHTML = `
                    <div class="item-image-container">
                        <img src="${item.image}" alt="${item.name}" class="item-image" onerror="this.src='https://via.placeholder.com/150x100?text=å›¾ç‰‡åŠ è½½å¤±è´¥'">
                        <span class="item-rarity">${item.rarity}</span>
                    </div>
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">${item.price.toFixed(2)} è±†</div>
                        <div class="item-wear">${item.wear}</div>
                    </div>
                `;
                
                elements.itemsGrid.appendChild(itemCard);
            });
        }

        // æ¸²æŸ“æœ€è¿‘å‡ºè´§
        function renderRecentDrops() {
            elements.recentDrops.innerHTML = '';
            
            if (gameState.recentDrops.length === 0) {
                elements.recentDrops.innerHTML = '<p>æš‚æ— æœ€è¿‘å‡ºè´§è®°å½•</p>';
                return;
            }
            
            gameState.recentDrops.forEach(drop => {
                const dropElement = document.createElement('div');
                dropElement.className = 'recent-drop';
                
                // æ ¹æ®ä»·æ ¼è®¾ç½®è¾¹æ¡†é¢œè‰²
                if (drop.price > 2000) {
                    dropElement.classList.add('border-gold');
                } else if (drop.price > 1500) {
                    dropElement.classList.add('border-orange');
                } else if (drop.price > 1000) {
                    dropElement.classList.add('border-red');
                } else if (drop.price > 500) {
                    dropElement.classList.add('border-purple');
                }
                
                dropElement.innerHTML = `
                    <img src="${drop.image}" alt="${drop.name}" class="recent-drop-image" onerror="this.src='https://via.placeholder.com/100x80?text=å›¾ç‰‡åŠ è½½å¤±è´¥'">
                    <div class="recent-drop-name">${drop.name}</div>
                    <div class="recent-drop-price">${drop.price.toFixed(2)} è±†</div>
                    <div class="recent-drop-time">${drop.time}åˆ†é’Ÿå‰</div>
                `;
                
                elements.recentDrops.appendChild(dropElement);
            });
        }

        // å¼€ç®±åŠŸèƒ½
        function openCase(count) {
            if (gameState.balance < 128.88 * count) {
                showNotification('ä½™é¢ä¸è¶³ï¼Œè¯·å……å€¼ï¼', 'error');
                elements.rechargeModal.style.display = 'flex';
                return;
            }
            
            // æ‰£é™¤ä½™é¢
            gameState.balance -= 128.88 * count;
            updateBalanceDisplay();
            saveGameState();
            
            // å‡†å¤‡æŠ½å¥–
            const results = [];
            for (let i = 0; i < count; i++) {
                results.push(getRandomItem());
            }
            
            // æ˜¾ç¤ºé€šçŸ¥
            if (count === 1) {
                showNotification('æ­£åœ¨å¼€å¯å•ä¸ªæ­¦å™¨ç®±...', 'info');
            } else {
                showNotification('æ­£åœ¨å¼€å¯äº”ä¸ªæ­¦å™¨ç®±...', 'info');
            }
            
            // æ˜¾ç¤ºæŠ½å¥–åŠ¨ç”»
            setTimeout(() => {
                showLotteryAnimation(results);
            }, 1000);
        }

        // è·å–éšæœºç‰©å“
        function getRandomItem() {
            // è®¡ç®—æ€»æ¦‚ç‡
            const totalProbability = items.reduce((sum, item) => sum + item.probability, 0);
            let random = Math.random() * totalProbability;
            
            // é€‰æ‹©ç‰©å“
            let selectedItem = null;
            for (const item of items) {
                random -= item.probability;
                if (random <= 0) {
                    selectedItem = {...item};
                    break;
                }
            }
            
            return selectedItem;
        }

        // æ˜¾ç¤ºæŠ½å¥–åŠ¨ç”»
        function showLotteryAnimation(results) {
            elements.lotteryAnimation.style.display = 'flex';
            elements.lotterySlots.innerHTML = '';
            
            const slotCount = results.length;
            const slotWidth = 1000;
            const itemWidth = 10;
            
            for (let i = 0; i < slotCount; i++) {
                const slotContainer = document.createElement('div');
                slotContainer.className = 'slot-container';
                
                const slotItems = document.createElement('div');
                slotItems.className = 'slot-items';
                
                // åˆ›å»ºè¶³å¤Ÿå¤šçš„ç‰©å“ç”¨äºæ»šåŠ¨
                const itemCount = 1000;
                for (let j = 0; j < itemCount; j++) {
                    const randomItem = getRandomItem();
                    const slotItem = document.createElement('div');
                    slotItem.className = 'slot-item';
                    slotItem.innerHTML = `<img src="${randomItem.image}" alt="${randomItem.name}" onerror="this.src='https://via.placeholder.com/100x100?text=å›¾ç‰‡åŠ è½½å¤±è´¥'">`;
                    slotItems.appendChild(slotItem);
                }
                
                // æ·»åŠ æŒ‡é’ˆ
                const pointer = document.createElement('div');
                pointer.className = 'slot-pointer';
                
                slotContainer.appendChild(slotItems);
                slotContainer.appendChild(pointer);
                elements.lotterySlots.appendChild(slotContainer);
                
                // è®¾ç½®åˆå§‹ä½ç½®
                const itemsElement = slotContainer.querySelector('.slot-items');
                itemsElement.style.left = `-${itemWidth * 30}px`;
                
                // å¼€å§‹åŠ¨ç”»
                setTimeout(() => {
                    animateSlot(slotContainer, results[i], i, slotCount);
                }, i * 500);
            }
        }

        // åŠ¨ç”»å•ä¸ªæ§½
        function animateSlot(slotContainer, result, index, totalSlots) {
            const itemsElement = slotContainer.querySelector('.slot-items');
            const itemWidth = 100;
            const targetPosition = -itemWidth * 50; // ä¸­é—´ä½ç½®
            
            let startTime = null;
            let currentPosition = parseInt(itemsElement.style.left);
            const duration = 2000 + index * 300; // 2ç§’åŸºç¡€ + æ¯ä¸ªæ§½å¢åŠ 0.3ç§’
            
            function step(timestamp) {
                if (!startTime) startTime = timestamp;
                const progress = (timestamp - startTime) / duration;
                
                if (progress < 1) {
                    // ç¼“åŠ¨å‡½æ•° - å…ˆåŠ é€Ÿåå‡é€Ÿ
                    const easedProgress = easeInOutCubic(progress);
                    const newPosition = currentPosition + (targetPosition - currentPosition) * easedProgress;
                    itemsElement.style.left = `${newPosition}px`;
                    requestAnimationFrame(step);
                } else {
                    // åŠ¨ç”»ç»“æŸï¼Œæ˜¾ç¤ºç»“æœ
                    itemsElement.style.left = `${targetPosition}px`;
                    
                    // å¦‚æœæ˜¯æœ€åä¸€ä¸ªæ§½ï¼Œæ˜¾ç¤ºç»“æœ
                    if (index === totalSlots - 1) {
                        setTimeout(() => {
                            elements.lotteryAnimation.style.display = 'none';
                            showLotteryResult(result, totalSlots);
                        }, 500);
                    }
                }
            }
            
            requestAnimationFrame(step);
        }

        // ç¼“åŠ¨å‡½æ•°
        function easeInOutCubic(t) {
            return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
        }

        // æ˜¾ç¤ºæŠ½å¥–ç»“æœ
        function showLotteryResult(result, totalSlots) {
            // æ·»åŠ åˆ°ä»“åº“
            gameState.inventory.push(result);
            
            // æ·»åŠ åˆ°å†å²è®°å½•
            gameState.lotteryHistory.push({
                date: new Date().toLocaleString(),
                item: result.name,
                wear: result.wear,
                price: result.price
            });
            
            // æ·»åŠ åˆ°æœ€è¿‘å‡ºè´§
            gameState.recentDrops.unshift({
                name: result.name,
                image: result.image,
                price: result.price,
                time: 0
            });
            
            // ä¿æŒæœ€è¿‘å‡ºè´§ä¸è¶…è¿‡8ä¸ª
            if (gameState.recentDrops.length > 8) {
                gameState.recentDrops.pop();
            }
            
            // æ›´æ–°æœ€è¿‘å‡ºè´§æ—¶é—´
            if (!window.recentDropsInterval) {
                window.recentDropsInterval = setInterval(() => {
                    gameState.recentDrops.forEach(drop => {
                        drop.time = (drop.time || 0) + 1;
                    });
                    renderRecentDrops();
                    saveGameState();
                }, 60000); // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡æ—¶é—´
            }
            
            // æ˜¾ç¤ºç»“æœ
            elements.resultItemImage.src = result.image;
            elements.resultItemImage.onerror = function() {
                this.src = 'https://via.placeholder.com/200x150?text=å›¾ç‰‡åŠ è½½å¤±è´¥';
            };
            elements.resultItemName.textContent = result.name;
            elements.resultItemWear.textContent = result.wear;
            elements.resultItemPrice.textContent = `${result.price.toFixed(2)} è±†`;
            elements.lotteryResult.style.display = 'block';
            
            // æ˜¾ç¤ºé€šçŸ¥
            if (totalSlots === 1) {
                showNotification(`æ­å–œè·å¾—: ${result.name} (${result.wear})`, 'success');
            } else {
                showNotification(`äº”è¿æŠ½å®Œæˆï¼Œæœ€åè·å¾—: ${result.name} (${result.wear})`, 'success');
            }
            
            // ä¿å­˜æ¸¸æˆçŠ¶æ€
            saveGameState();
            
            // æ›´æ–°UI
            renderRecentDrops();
        }

        // ç½®æ¢ç‰©å“
        function exchangeItem() {
            const resultName = elements.resultItemName.textContent;
            const resultPrice = parseFloat(elements.resultItemPrice.textContent);
            
            // ä»ä»“åº“ç§»é™¤
            gameState.inventory = gameState.inventory.filter(item => !(item.name === resultName && item.price === resultPrice));
            
            // æ·»åŠ åˆ°ä½™é¢
            gameState.balance += resultPrice;
            
            // æ›´æ–°æ˜¾ç¤º
            updateBalanceDisplay();
            elements.lotteryResult.style.display = 'none';
            
            // æ˜¾ç¤ºé€šçŸ¥
            showNotification(`æˆåŠŸç½®æ¢ ${resultName}ï¼Œè·å¾— ${resultPrice.toFixed(2)} è±†`, 'success');
            
            // ä¿å­˜æ¸¸æˆçŠ¶æ€
            saveGameState();
        }

        // æ‰“å¼€ä»“åº“æ¨¡æ€æ¡†
        function openInventoryModal() {
            elements.inventoryModal.style.display = 'flex';
            renderInventory();
        }

        // æ¸²æŸ“ä»“åº“
        function renderInventory() {
            elements.inventoryItems.innerHTML = '';
            
            if (gameState.inventory.length === 0) {
                elements.inventoryItems.innerHTML = '<p>ä»“åº“ç©ºç©ºå¦‚ä¹Ÿï¼Œå¿«å»å¼€ç®±å§ï¼</p>';
                return;
            }
            
            // æŒ‰ä»·æ ¼æ’åº
            const sortedInventory = [...gameState.inventory].sort((a, b) => a.price - b.price);
            
            sortedInventory.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'item-card';
                itemElement.dataset.name = item.name;
                itemElement.dataset.price = item.price;
                
                // æ ¹æ®ä»·æ ¼è®¾ç½®è¾¹æ¡†é¢œè‰²
                if (item.price > 2000) {
                    itemElement.classList.add('border-gold');
                } else if (item.price > 1500) {
                    itemElement.classList.add('border-orange');
                } else if (item.price > 1000) {
                    itemElement.classList.add('border-red');
                } else if (item.price > 500) {
                    itemElement.classList.add('border-purple');
                }
                
                itemElement.innerHTML = `
                    <div class="item-image-container">
                        <img src="${item.image}" alt="${item.name}" class="item-image" onerror="this.src='https://via.placeholder.com/150x100?text=å›¾ç‰‡åŠ è½½å¤±è´¥'">
                        <span class="item-rarity">${item.rarity}</span>
                    </div>
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">${item.price.toFixed(2)} è±†</div>
                        <div class="item-wear">${item.wear}</div>
                    </div>
                `;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                itemElement.addEventListener('click', () => {
                    itemElement.classList.toggle('selected');
                });
                
                elements.inventoryItems.appendChild(itemElement);
            });
            
            // æ¸²æŸ“æ­£åœ¨å‘é€çš„ç‰©å“
            renderSendingItems();
        }

        // æ¸²æŸ“æ­£åœ¨å‘é€çš„ç‰©å“
        function renderSendingItems() {
            elements.sendingItems.innerHTML = '';
            
            if (gameState.sendingItems.length === 0) {
                elements.sendingItems.innerHTML = '<p>æ²¡æœ‰æ­£åœ¨å‘é€çš„ç‰©å“</p>';
                return;
            }
            
            gameState.sendingItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'item-card';
                
                // æ ¹æ®ä»·æ ¼è®¾ç½®è¾¹æ¡†é¢œè‰²
                if (item.price > 2000) {
                    itemElement.classList.add('border-gold');
                } else if (item.price > 1500) {
                    itemElement.classList.add('border-orange');
                } else if (item.price > 1000) {
                    itemElement.classList.add('border-red');
                } else if (item.price > 500) {
                    itemElement.classList.add('border-purple');
                }
                
                itemElement.innerHTML = `
                    <div class="item-image-container">
                        <img src="${item.image}" alt="${item.name}" class="item-image" onerror="this.src='https://via.placeholder.com/150x100?text=å›¾ç‰‡åŠ è½½å¤±è´¥'">
                        <span class="item-rarity">${item.rarity}</span>
                    </div>
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">${item.price.toFixed(2)} è±†</div>
                        <div class="item-wear">${item.wear}</div>
                    </div>
                `;
                
                elements.sendingItems.appendChild(itemElement);
            });
        }

        // æ£€æŸ¥æ­£åœ¨å‘é€çš„ç‰©å“
        function checkSendingItems() {
            if (gameState.sendingItems.length > 0) {
                const sendingItem = gameState.sendingItems[0];
                const now = new Date();
                const sendTime = new Date(sendingItem.sendTime);
                const elapsed = now - sendTime;
                const remaining = 10 * 60 * 1000 - elapsed; // 10åˆ†é’Ÿ
                
                if (remaining <= 0) {
                    // å‘é€å®Œæˆ
                    gameState.sendingItems.shift();
                    saveGameState();
                } else {
                    // æ›´æ–°å€’è®¡æ—¶
                    updateSendingTimer(remaining);
                }
            }
        }

        // æ›´æ–°å‘é€è®¡æ—¶å™¨
        function updateSendingTimer(remainingMs) {
            const minutes = Math.floor(remainingMs / 60000);
            const seconds = Math.floor((remainingMs % 60000) / 1000);
            elements.sendingTimer.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            if (remainingMs > 0) {
                setTimeout(() => updateSendingTimer(remainingMs - 1000), 1000);
            } else {
                // å‘é€å®Œæˆ
                gameState.sendingItems.shift();
                saveGameState();
                renderSendingItems();
                elements.sendingTimer.textContent = "å·²å®Œæˆ";
                showNotification('ç‰©å“å·²æˆåŠŸå‘é€åˆ°æŒ‡å®šä»“åº“', 'success');
            }
        }

        // ä¸€é”®åˆ†è§£
        function decomposeItems() {
            const selectedItems = document.querySelectorAll('.inventory-items .item-card.selected');
            
            if (selectedItems.length === 0) {
                // å¦‚æœæ²¡æœ‰é€‰æ‹©ï¼Œé»˜è®¤åˆ†è§£æœ€ä¾¿å®œçš„10ä¸ª
                const allItems = document.querySelectorAll('.inventory-items .item-card');
                const itemsToDecompose = Array.from(allItems)
                    .sort((a, b) => parseFloat(a.dataset.price) - parseFloat(b.dataset.price))
                    .slice(0, 10);
                
                itemsToDecompose.forEach(item => item.classList.add('selected'));
                decomposeItems(); // é€’å½’è°ƒç”¨
                return;
            }
            
            let totalValue = 0;
            selectedItems.forEach(item => {
                totalValue += parseFloat(item.dataset.price);
                const itemName = item.dataset.name;
                const itemPrice = parseFloat(item.dataset.price);
                
                // ä»ä»“åº“ç§»é™¤
                gameState.inventory = gameState.inventory.filter(i => !(i.name === itemName && i.price === itemPrice));
            });
            
            // æ·»åŠ åˆ°ä½™é¢
            gameState.balance += totalValue * 0.9; // 90%ä»·å€¼
            updateBalanceDisplay();
            
            // é‡æ–°æ¸²æŸ“ä»“åº“
            renderInventory();
            
            // ä¿å­˜æ¸¸æˆçŠ¶æ€
            saveGameState();
            
            showNotification(`æˆåŠŸåˆ†è§£ ${selectedItems.length} ä»¶ç‰©å“ï¼Œè·å¾— ${(totalValue * 0.9).toFixed(2)} è±†`, 'success');
        }

        // å…¨éƒ¨ç½®æ¢
        function exchangeAllItems() {
            if (gameState.inventory.length === 0) {
                showNotification('ä»“åº“ä¸­æ²¡æœ‰å¯ç½®æ¢çš„ç‰©å“', 'warning');
                return;
            }
            
            const totalValue = gameState.inventory.reduce((sum, item) => sum + item.price, 0);
            gameState.balance += totalValue;
            gameState.inventory = [];
            
            updateBalanceDisplay();
            renderInventory();
            saveGameState();
            
            showNotification(`æˆåŠŸç½®æ¢æ‰€æœ‰ç‰©å“ï¼Œè·å¾— ${totalValue.toFixed(2)} è±†`, 'success');
        }

        // å–æ¶ˆå‘é€
        function cancelSending() {
            if (gameState.sendingItems.length === 0) {
                showNotification('æ²¡æœ‰æ­£åœ¨å‘é€çš„ç‰©å“', 'warning');
                return;
            }
            
            // å°†å‘é€ä¸­çš„ç‰©å“ç§»å›ä»“åº“
            gameState.inventory.push(...gameState.sendingItems);
            gameState.sendingItems = [];
            
            // æ›´æ–°UI
            renderInventory();
            renderSendingItems();
            saveGameState();
            
            showNotification('å·²å–æ¶ˆå‘é€ï¼Œç‰©å“å·²è¿”å›ä»“åº“', 'success');
        }

        // æ‰“å¼€å†å²è®°å½•æ¨¡æ€æ¡†
        function openHistoryModal() {
            elements.historyModal.style.display = 'flex';
            renderRechargeHistory();
            renderLotteryHistory();
        }

        // æ¸²æŸ“å……å€¼å†å²
        function renderRechargeHistory() {
            elements.rechargeHistoryTable.innerHTML = '';
            
            if (gameState.rechargeHistory.length === 0) {
                elements.rechargeHistoryTable.innerHTML = '<tr><td colspan="3">æš‚æ— å……å€¼è®°å½•</td></tr>';
                return;
            }
            
            gameState.rechargeHistory.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.amount.toFixed(2)}</td>
                    <td>${record.status}</td>
                `;
                elements.rechargeHistoryTable.appendChild(row);
            });
        }

        // æ¸²æŸ“å¼€ç®±å†å²
        function renderLotteryHistory() {
            elements.lotteryHistoryTable.innerHTML = '';
            
            if (gameState.lotteryHistory.length === 0) {
                elements.lotteryHistoryTable.innerHTML = '<tr><td colspan="4">æš‚æ— å¼€ç®±è®°å½•</td></tr>';
                return;
            }
            
            gameState.lotteryHistory.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.item}</td>
                    <td>${record.wear}</td>
                    <td>${record.price.toFixed(2)}</td>
                `;
                elements.lotteryHistoryTable.appendChild(row);
            });
        }

        // å¼€å§‹å……å€¼
        function startRecharge() {
            const amount = parseFloat(elements.rechargeAmount.value);
            
            if (isNaN(amount) || amount <= 0) {
                showNotification('è¯·è¾“å…¥æœ‰æ•ˆçš„å……å€¼é‡‘é¢', 'error');
                return;
            }
            
            // æ˜¾ç¤ºäºŒç»´ç 
            elements.qrCode.style.display = 'block';
            elements.rechargeAfterButtons.style.display = 'flex';
            elements.rechargeConfirm.style.display = 'none';
            elements.rechargeCancel.style.display = 'none';
        }

        // å®Œæˆå……å€¼
        function completeRecharge() {
            const amount = parseFloat(elements.rechargeAmount.value);
            
            // æ·»åŠ åˆ°ä½™é¢
            gameState.balance += amount;
            
            // æ·»åŠ åˆ°å……å€¼å†å²
            gameState.rechargeHistory.push({
                date: new Date().toLocaleString(),
                amount: amount,
                status: 'æˆåŠŸ'
            });
            
            // æ›´æ–°UI
            updateBalanceDisplay();
            elements.rechargeModal.style.display = 'none';
            elements.qrCode.style.display = 'none';
            elements.rechargeAfterButtons.style.display = 'none';
            elements.rechargeConfirm.style.display = 'block';
            elements.rechargeCancel.style.display = 'block';
            elements.rechargeAmount.value = '';
            
            // ä¿å­˜æ¸¸æˆçŠ¶æ€
            saveGameState();
            
            showNotification(`å……å€¼æˆåŠŸï¼å·²æ·»åŠ  ${amount.toFixed(2)} è±†åˆ°æ‚¨çš„è´¦æˆ·`, 'success');
        }

        // å¤„ç†å……å€¼é—®é¢˜
        function handleRechargeProblem() {
            elements.rechargeFeedback.style.display = 'block';
            
            setTimeout(() => {
                elements.rechargeFeedback.style.display = 'none';
                completeRecharge(); // æ— è®ºå¦‚ä½•éƒ½å®Œæˆå……å€¼
            }, 10000); // 10ç§’åè‡ªåŠ¨å®Œæˆ
        }

        // ä¿å­˜æ¸¸æˆçŠ¶æ€
        function saveGameState() {
            localStorage.setItem('csgoCaseGameState', JSON.stringify(gameState));
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>